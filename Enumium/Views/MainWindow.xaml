<Window x:Class="Enumium.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Enumium.ViewModels"
        xmlns:views="clr-namespace:Enumium.Views"
        Title="Enumium - System Optimizer" Height="750" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStyle="None" AllowsTransparency="True"
        Background="Transparent" WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <DataTemplate DataType="{x:Type vm:DashboardViewModel}">
            <views:DashboardView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:PerformanceViewModel}">
            <views:PerformanceView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:CleanerViewModel}">
            <views:CleanerView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:StartupViewModel}">
            <views:StartupView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:NetworkViewModel}">
            <views:NetworkView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:PrivacyViewModel}">
            <views:PrivacyView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:ToolsViewModel}">
            <views:ToolsView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:ReportsViewModel}">
            <views:ReportsView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type vm:AboutViewModel}">
            <views:AboutView/>
        </DataTemplate>

        <!-- Nav Item Style with MDL2 Icons -->
        <Style x:Key="NavItemStyle" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="NavBorder" Background="Transparent" Padding="14,10"
                                Cursor="Hand" CornerRadius="8" Margin="6,2">
                            <Grid>
                                <!-- Active indicator bar -->
                                <Border x:Name="ActiveIndicator" Width="3" Height="20" HorizontalAlignment="Left"
                                        Margin="-14,0,0,0" CornerRadius="0,2,2,0" Opacity="0">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <GradientStop Color="#FF6C5CE7" Offset="0"/>
                                            <GradientStop Color="#FF00CEC9" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="NavIcon" Text="{TemplateBinding Tag}"
                                               FontFamily="Segoe Fluent Icons, Segoe MDL2 Assets"
                                               FontSize="16" VerticalAlignment="Center"
                                               Margin="0,0,12,0" Width="24" TextAlignment="Center"/>
                                    <TextBlock x:Name="NavText" Text="{TemplateBinding Content}"
                                               FontSize="13" VerticalAlignment="Center"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               FontFamily="{StaticResource PrimaryFont}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="NavBorder" Property="Background" Value="#15FFFFFF"/>
                                <Setter TargetName="NavText" Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="NavBorder" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                            <GradientStop Color="#206C5CE7" Offset="0"/>
                                            <GradientStop Color="#1000CEC9" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="NavText" Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                <Setter TargetName="NavText" Property="FontWeight" Value="SemiBold"/>
                                <Setter TargetName="ActiveIndicator" Property="Opacity" Value="1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Title Bar Button -->
        <Style x:Key="WinBtn" TargetType="Button">
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bg" Background="{TemplateBinding Background}">
                            <TextBlock Text="{TemplateBinding Content}"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"
                                       FontSize="{TemplateBinding FontSize}"
                                       Foreground="{TemplateBinding Foreground}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bg" Property="Background" Value="#20FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CloseBtn" TargetType="Button" BasedOn="{StaticResource WinBtn}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bg" Background="Transparent" CornerRadius="0,10,0,0">
                            <TextBlock Text="{TemplateBinding Content}"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"
                                       FontSize="13" Foreground="{StaticResource TextSecondaryBrush}"
                                       x:Name="Txt"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bg" Property="Background" Value="#CCE81123"/>
                                <Setter TargetName="Txt" Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- Fade-in animation on load -->
    <Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="RootBorder"
                                     Storyboard.TargetProperty="Opacity"
                                     From="0" To="1" Duration="0:0:0.5">
                        <DoubleAnimation.EasingFunction>
                            <CubicEase EasingMode="EaseOut"/>
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers>

    <!-- Main Border -->
    <Border x:Name="RootBorder" CornerRadius="10" Background="{StaticResource BackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Opacity="0">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ═══ CUSTOM TITLE BAR ═══ -->
            <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}"
                    CornerRadius="10,10,0,0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="14,0,0,0" VerticalAlignment="Center">
                        <TextBlock FontSize="14" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,6,0">
                            <TextBlock.Foreground>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="#FF6C5CE7" Offset="0"/>
                                    <GradientStop Color="#FF00CEC9" Offset="1"/>
                                </LinearGradientBrush>
                            </TextBlock.Foreground>
                            ◆
                        </TextBlock>
                        <TextBlock Text="ENUMIUM" FontSize="13" FontWeight="Bold" Foreground="{StaticResource TextPrimaryBrush}"
                                   FontFamily="{StaticResource PrimaryFont}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="—" Foreground="{StaticResource BorderBrush}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="{Binding CurrentPageName}" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                   FontFamily="{StaticResource PrimaryFont}" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Window Controls: use text that's universally available -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button Style="{StaticResource WinBtn}" Content="&#xE921;" FontFamily="Segoe Fluent Icons, Segoe MDL2 Assets" FontSize="10"
                                Command="{Binding MinimizeCommand}"/>
                        <Button Style="{StaticResource WinBtn}" Content="&#xE922;" FontFamily="Segoe Fluent Icons, Segoe MDL2 Assets" FontSize="10"
                                Command="{Binding MaximizeCommand}"/>
                        <Button Style="{StaticResource CloseBtn}" Content="&#xE8BB;" FontFamily="Segoe Fluent Icons, Segoe MDL2 Assets" FontSize="10"
                                Command="{Binding CloseCommand}"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ═══ MAIN CONTENT AREA ═══ -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- ═══ LEFT NAV SIDEBAR ═══ -->
                <Border Grid.Column="0" Background="{StaticResource SurfaceBrush}"
                        BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Margin="0,12,0,0">
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE80F;" Content="{Binding NavDashboard}"
                                         GroupName="Nav" IsChecked="True"
                                         Command="{Binding NavigateCommand}" CommandParameter="Dashboard"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE945;" Content="{Binding NavPerformance}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Performance"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE9F3;" Content="{Binding NavCleaner}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Cleaner"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE7B5;" Content="{Binding NavStartup}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Startup"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE774;" Content="{Binding NavNetwork}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Network"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE72E;" Content="{Binding NavPrivacy}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Privacy"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE90F;" Content="{Binding NavTools}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Tools"/>
                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE9D5;" Content="{Binding NavReports}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="Reports"/>

                            <!-- Separator -->
                            <Border Height="1" Background="{StaticResource BorderBrush}" Margin="16,8"/>

                            <RadioButton Style="{StaticResource NavItemStyle}" Tag="&#xE946;" Content="{Binding NavAbout}"
                                         GroupName="Nav"
                                         Command="{Binding NavigateCommand}" CommandParameter="About"/>
                        </StackPanel>

                        <!-- Version info at bottom -->
                        <StackPanel Grid.Row="1" Margin="14,0,14,14">
                            <Border Height="1" Background="{StaticResource BorderBrush}" Margin="0,0,0,10"/>
                            <TextBlock Text="Enumium v1.0.2  ◆  enum000" FontSize="10"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontFamily="{StaticResource PrimaryFont}"
                                       HorizontalAlignment="Center" Opacity="0.5"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- ═══ PAGE CONTENT ═══ -->
                <Border Grid.Column="1" Padding="0">
                    <ContentControl Content="{Binding CurrentPage}"/>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
